from pwn import *
unsual_time_index = 0
unsual_time = ['2024-02-13 11:40:01','2024-02-13 11:40:58','2024-02-13 11:42:01','2024-02-13 11:56:01','2024-02-15 10:41:51','2024-02-15 18:52:01','2024-02-15 18:56:01','2024-02-15 18:57:01','2024-02-16 10:27:11','2024-02-16 10:28:29','2024-02-16 12:38:11','2024-02-16 14:40:47','2024-02-19 04:00:18','2024-02-19 04:00:20','2024-02-19 04:00:40','2024-02-19 04:01:01','2024-02-19 04:01:15','2024-02-19 04:02:27','2024-02-19 04:10:02','2024-02-19 04:12:02','2024-02-19 04:14:02','2024-02-20 11:11:14','2024-02-20 11:48:40','2024-02-20 11:49:29','2024-02-20 13:50:14','2024-02-20 14:50:04','2024-02-21 10:51:27','2024-02-21 10:52:58','2024-02-21 18:17:59','2024-02-22 12:09:39','2024-02-22 12:19:28','2024-02-22 12:20:10','2024-02-22 17:20:10','2024-02-23 10:49:50','2024-02-23 10:51:19','2024-02-23 12:50:46','2024-02-23 12:51:19','2024-02-23 12:52:01','2024-02-23 18:18:06','2024-02-23 18:19:17','2024-02-23 18:21:01','2024-02-24 11:16:08','2024-02-24 11:17:07','2024-02-24 13:20:18','2024-02-24 13:20:25','2024-02-24 14:08:18','2024-02-26 10:00:17','2024-02-26 10:20:31','2024-02-26 10:21:20','2024-02-26 15:07:18','2024-02-26 15:07:57','2024-02-26 15:10:57','2024-02-26 17:27:10','2024-02-26 18:30:46','2024-02-26 18:37:10','2024-02-27 13:42:37','2024-02-27 13:43:09','2024-02-27 13:59:01','2024-02-27 14:30:29','2024-02-27 15:31:59','2024-02-27 15:58:18','2024-02-27 17:16:39','2024-02-28 17:19:50','2024-02-28 18:28:01','2024-02-28 18:37:09','2024-02-28 18:40:11','2024-02-29 09:58:14','2024-02-29 10:20:14','2024-02-29 10:23:14','2024-02-29 18:01:50','2024-02-29 18:20:11','2024-02-29 18:20:18','2024-02-29 18:21:19','2024-02-29 18:50:20','2024-02-29 18:51:45','2024-02-29 18:52:20']
timeTwo=['2024-01-19 12:59:11','2024-01-19 12:59:11','2024-01-28 15:24:23','2024-01-28 15:24:24','2024-01-28 15:24:33','2024-01-28 15:24:39','2024-01-28 15:24:43','2024-01-28 15:24:43','2024-02-13 11:29:50','2024-02-13 11:29:50','2024-02-13 11:29:50','2024-02-13 11:29:50','2024-02-13 11:57:16','2024-02-13 11:57:16','2024-02-13 11:57:16','2024-02-15 10:40:47','2024-02-15 10:40:48','2024-02-15 10:40:50','2024-02-15 10:40:51','2024-02-15 10:42:20','2024-02-15 10:42:20','2024-02-15 10:42:20','2024-02-15 18:51:47','2024-02-15 18:51:48','2024-02-15 18:51:50','2024-02-15 18:51:51','2024-02-15 18:59:39','2024-02-15 18:59:39','2024-02-15 18:59:39','2024-02-16 10:26:47','2024-02-16 10:26:48','2024-02-16 10:26:50','2024-02-16 10:26:51','2024-02-16 14:47:28','2024-02-16 14:47:28','2024-02-16 14:47:28','2024-02-19 04:00:14','2024-02-19 04:00:14','2024-02-19 04:00:14','2024-02-19 04:00:14','2024-02-19 04:38:17','2024-02-19 04:38:17','2024-02-19 04:38:17','2024-02-20 11:10:14','2024-02-20 11:10:14','2024-02-20 11:10:14','2024-02-20 11:10:14','2024-02-20 14:58:17','2024-02-20 14:58:17','2024-02-20 14:58:17','2024-02-21 10:49:47','2024-02-21 10:49:49','2024-02-21 10:49:50','2024-02-21 10:49:50','2024-02-21 13:11:14','2024-02-21 13:11:14','2024-02-21 13:11:14','2024-02-21 18:17:47','2024-02-21 18:17:49','2024-02-21 18:17:50','2024-02-21 18:17:50','2024-02-21 18:59:59','2024-02-21 18:59:59','2024-02-21 18:59:59','2024-02-22 12:07:14','2024-02-22 12:07:14','2024-02-22 12:07:14','2024-02-22 12:07:14','2024-02-22 18:59:59','2024-02-22 18:59:59','2024-02-22 18:59:59','2024-02-23 10:49:47','2024-02-23 10:49:49','2024-02-23 10:49:50','2024-02-23 10:49:50','2024-02-23 13:11:14','2024-02-23 13:11:14','2024-02-23 13:11:14','2024-02-23 18:17:47','2024-02-23 18:17:49','2024-02-23 18:17:50','2024-02-23 18:17:50','2024-02-23 18:59:59','2024-02-23 18:59:59','2024-02-23 18:59:59','2024-02-24 11:15:08','2024-02-24 11:15:08','2024-02-24 11:15:08','2024-02-24 11:15:08','2024-02-24 13:27:02','2024-02-24 13:27:02','2024-02-24 13:27:02','2024-02-24 14:07:18','2024-02-24 14:07:18','2024-02-24 14:07:18','2024-02-24 14:07:18','2024-02-24 15:11:02','2024-02-24 15:11:02','2024-02-24 15:11:02','2024-02-26 09:57:01','2024-02-26 09:57:01','2024-02-26 09:57:01','2024-02-26 09:57:01','2024-02-26 10:31:19','2024-02-26 10:31:19','2024-02-26 10:31:19','2024-02-26 15:07:18','2024-02-26 15:07:18','2024-02-26 15:07:18','2024-02-26 15:07:18','2024-02-26 18:59:59','2024-02-26 18:59:59','2024-02-26 18:59:59','2024-02-27 13:41:23','2024-02-27 13:41:24','2024-02-27 13:41:33','2024-02-27 13:41:39','2024-02-27 13:41:43','2024-02-27 13:41:43','2024-02-27 13:41:48','2024-02-27 13:41:48','2024-02-27 13:41:51','2024-02-27 13:41:51','2024-02-27 18:39:16','2024-02-27 18:39:16','2024-02-27 18:39:16','2024-02-28 17:19:47','2024-02-28 17:19:49','2024-02-28 17:19:50','2024-02-28 17:19:50','2024-02-28 18:59:59','2024-02-28 18:59:59','2024-02-28 18:59:59','2024-02-29 09:57:01','2024-02-29 09:57:01','2024-02-29 09:57:01','2024-02-29 09:57:01','2024-02-29 10:31:19','2024-02-29 10:31:19','2024-02-29 10:31:19','2024-02-29 18:01:28','2024-02-29 18:01:29','2024-02-29 18:01:29','2024-02-29 18:01:29','2024-02-29 18:59:59','2024-02-29 18:59:59','2024-02-29 18:59:59']
answer = ['100.107.36.130:2221','2024-02-13 11:29:50','2024-02-19 04:00:14','OPkBSs6okUKraq8pYo4XwwBg55QSo210F09FCe1-yj4','whoami','./setup']
while 1:
	print(unsual_time_index)
	s = connect('94.237.48.92','54546')
	s.recvuntil(b'in the logs')
	print("Stage 1:")
	for i in answer:
		print(s.recvuntil(b'> ').decode())
		print(i)
		s.sendline(i.encode())
	print(s.recvuntil(b'> ').decode())
	print("Stage 2:")
	dk = 0
	for i in timeTwo[unsual_time_index:]:
		unsual_time_index+=1
		print(i)
		s.send(i.encode())
		info=s.recvuntil(b'> ')
		print(info)
		if(b'Correct' in info):
			input()
		if(b'Wrong Answer' in info):
			dk+=1
		if(dk==2):
			print('Ket Noi Lai')
			break
	s.close()
